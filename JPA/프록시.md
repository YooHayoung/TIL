# 프록시

## 프록시란?
- 데이터 조회시 연관된 객체를 가져오는 것을 미룬다.
- DB 조회를 미루는 가짜 엔티티 객체
- 실제 클래스를 상속받아서 만들어진다.
- 실제 클래스와 겉모양이 같다.
- 사용하는 입장에서는 진짜 객체인지 프록시 객체인지 구분하지않고 사용하면 된다. <- 이론상

## 프록시 객체의 특징
- 프록시 객체는 실제 객체의 참조를 보관한다
- 프록시 객체를 호출하면 프록시 객체는 실제 객체의 메서드를 호출한다
- 프록시 객체는 처음 사용할 때 한 번만 초기화한다
- 프록시 객체가 초기화된다고 실제 엔티티로 바뀌는 것이 아니다.
- 타입 체크시 instance of를 사용한다. 원본 엔티티를 상속받은 것이기 때문이다.

## 그래서 프록시는 어떻게 쓰지?
- @ManyToOne, @OneToMany 등 다중성 설정할 때 fetch 속성을 지정해준다.
- 지연로딩, 즉시로딩 있다.
- 지연로딩
  - fetch=FetchType.LAZY
  - 해당 속성이 지정된 참조 객체는 프록시로 조회되어 프록시가 사용될 때 까지 실제 엔티티 조회를 미룬다.
- 즉시로딩
  - fetch=FetchType.EAGER
  - 객체 조회시 프록시로 가져오는 것이 아니라 실제 엔티티를 같이 가져온다.

## 가능하면 지연로딩만 쓰자!
- 즉시로딩을 적용하면 예상하지 못한 SQL이 발생한다.
- 즉시로딩은 JPQL에서 N + 1 문제를 발생시킨다.
- ToOne은 기본이 즉시로딩이다. LAZY로 설정해주자.
- ToMany는 기본이 지연로딩이다.

<br>













<br><br><br><br>

---

해당 내용은 김영한님의 강의를 듣고 정리한 내용입니다.